<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cn.ctbri.entity.TaskHWMapper">
<sql id="cols">taskId,order_ip_Id,execute_time,status,remarks</sql>
	<resultMap type="com.cn.ctbri.entity.TaskHW" id="TaskHWRM">
		<id property="taskId" column="taskId"/>
		<result property="order_ip_Id" column="order_ip_Id"/>
		<result property="execute_time" column="execute_time"/>
		<result property="status" column="status"/>
		<result property="remarks" column="remarks"/>
	</resultMap> 
	
	<!-- 插入任务信息 -->
	<insert id="insert" parameterType="com.cn.ctbri.entity.TaskHW" useGeneratedKeys="true" keyProperty="id">
		INSERT INTO cs_taskhuawei
		(order_ip_Id,execute_time,status,remarks) 
		VALUES( #{order_ip_Id} , #{execute_time},#{status},#{remarks})
	</insert>
	
	<!-- 根据条件查询任务表 -->
    <select id="findTaskhw" parameterType="hashmap" resultMap="TaskHWRM">
        select * from cs_taskhuawei t
        where t.status = #{status} 
        <if test="status==1">
          and t.execute_time between date_add(now(),interval -1 minute) and now()
        </if>
    </select>
    
    <!-- 更新任务信息 -->
    <update id="update"  parameterType="com.cn.ctbri.entity.TaskHW">
        update cs_taskhuawei
        <set>
            <if test="status!=null">
                status=#{status} , 
            </if>
            <if test="execute_time!=null">
                execute_time=#{execute_time},
            </if>
        </set>
        where taskId = #{taskId}
    </update>
</mapper>